//-------------------------------------------------------------

Program versions : 1.9.3

Descrription: 
	This is the code for the water cooler.
	
Information:
	Chip: STC8C2K32S2
	Clock: 11.0592MHZ 1T	
	
Function:
	长按童锁键3s锁住其他按键，长按磁化键3s切换高原模式和普通模式，并且存在EEPROM中，断电保存当前状态。
	[高原模式:热水出水温度为85°][普通模式:热水出水温度为93°]
	
	按开水键出水口出热水，电磁阀打开，按键下方图案亮起
	按冷水键出水口出冷水，电磁阀打开，按键下方图案亮起
	
	按磁化水键，磁化电机旋转。共有三个档位。磁化模式时倒计时60分钟，磁化挡位显示
	
	开水2min后自动关水
	缺水时蜂鸣器会响三下，并且关闭供水。
	
	按键带有互斥功能，按下按键蜂鸣器会响200ms
	
	流量计判断缺水后自动掐断开关水
	
	......
	
modification: 2024/8/16 11:51

modifier: Cameron Bright

//------------------------------------------------------------

[*** : 稳定版,功能正常使用] [--- : 测试版,某些功能切换为调试模式] [~~~: 稳定出货版,已经过老化测试验证的版本]


Change Log:
	V0.1  July 22th 2024     ||   1  新建工程，GPIO口基本配置以及烧录测试完成
	V1.0  July 22th 2024     ||   1  基本框架搭建完成，定时器中断和按键扫描都正常运作
	V1.1  July 24th 2024     ||   1  新增按键出水控制，并添加互斥锁
								  2  增加软件pwm
								  3  增加LED定义，现在按键上的LED灯可控
	
	V1.2  July 24th 2024     ||   1  修改了蜂鸣器控制方式，现在可自由选择蜂鸣器短响的时间
								  2  优化了PWM的代码
								  3  磁化水模式交互完成
	
	V1.3  July 26th 2024     ||   1  增加了数码管的驱动代码
								  2  磁化水模式交互优化
								  3  增加了磁化水时间倒计时
								  
	V1.4  July 26th 2024     ||   1  优化了所有数码管的驱动
								  2  新增了按键下方LED提示的代码以及磁化挡位的代码
								  3  修复了磁化电机转动不正常的问题，占空比修正为40 30 20
								 
	V1.5  July 26th 2024     ||   1  修改定时器为Timer1,功能均正常								 

***	V1.5.1 July 27th 2024    ||   1  修复了一些bug，优化了交互界面功能，取消了电磁阀控制，现在为常开状态。童锁为关闭电磁阀
								  2  此版本为开关水和磁化功能正常的稳定版
								  
	V1.6 July 27th 2024    	 ||   1  增加了关水电磁阀延迟1s关断的代码 暂未验证
	V1.6.1 July 29th 2024    ||   1  删掉了电磁阀的控制代码，电磁阀上电常开
	
	V1.7 July 29th 2024      ||   1  此版本电磁阀常开，磁化时间数码管显示的是流量计流量
						     ||	  2  增加了流量计的驱动代码，使用GPIO口作为外部中断测量流量计的频率
							 ||   3  增加了防干烧功能，延迟检测还没有加
							 
	V1.7.1 July 29th 2024    ||   1  此版本电磁阀常开，磁化时间数码管显示的是流量计流量
							 ||   2  按键长短按功能完成，但是长按会一直触发翻转。
							 
	V1.7.2 July 30th 2024    ||   1  此版本电磁阀常开
							 ||   2  按键长短按功能完成,修复长按会一直执行功能的问题
							 
	V1.7.5 July 30th 2024    ||   1  此版本电磁阀常开，蜂鸣器常关
							 ||   2  修复了流量计防干烧功能影响按键的bug，流量计检测没流量2s之后才会关水
							 
	V1.7.6 July 30th 2024    ||   1  此版本电磁阀常开，蜂鸣器常关
							 ||   2  灯圈从常量修改为磁化时才会亮	
							 ||   3  修复了按童锁键冷热水led常量的问题
							 ||   4  磁化电机关时&&倒计时结束时，倒计时复位为60
	
	V1.7.7 July 31th 2024    ||   1  此版本电磁阀常开，蜂鸣器常关
							 ||   2  新增了开水2min分钟后自动关水
							 ||   3  修复了定时器计时不准的问题
							 
***	V1.8 July 31th 2024      ||   1  此版本电磁阀常开
							 ||   2  此版本为功能均正常使用的稳定版
 
  	V1.8.1 Aug 3rd 2024      ||   1  此版本加入了电磁阀开关
							 ||   2  修复了使用电磁阀会喷水的问题，现在每次开热水都会先出几秒冷水，同时检测流量，有流量才给出热水							
							
	V1.8.1 Aug 3rd 2024      ||   1  此版本加入了电磁阀开关
							 ||   2  加快了频率测量的周期(100ms)
							 
	V1.8.2 Aug 5th 2024      ||   1  增加了按开关前2s不检测流量的功能
							 ||   2  加快了频率测量的周期(100ms)
							 ||   3  修复了缺水保护之后再开水会喷水的问题
							 ||   4  修复了缺水的时候会喷水的问题
							 
---	V1.8.3 Aug 5th 2024      ||   1  发现了电磁阀会过热的问题，已通过代码尽量修复
							 ||   2 此版本为测试版本，按童锁键切换电磁阀开关，数码管显示电磁阀状态。1为开
							 
	V1.8.4 Aug 5th 2024      ||   1 新增了蜂鸣器响三下的函数，调整了蜂鸣器的交互
	V1.8.5 Aug 6th 2024      ||   1 修复了蜂鸣器交互打断缺水保护的bug
	
	V1.8.6 Aug 6th 2024      ||   1 增加了高原模式,长按三秒磁化键切换普通模式和高原模式
							 
***	V1.8.7 Aug 7th 2024      ||   1 增加了断电保存功能，保存高原模式和普通模式
							 ||   2 此版本为稳定版 
							 
*** V1.8.8 Aug 7th 2024      ||   1 调整了电磁阀与水泵的关系，开水先开电磁阀，300ms后再开水泵，关水先关水泵再关电磁阀
							 ||   2 增加了切换模式时显示当前状态，显示1时高原模式，0时普通模式
							 ||   3 修复了童锁键锁住的时候可以切换高原模式的bug
							 ||   4 此版本为全功能的稳定版
							 
--- V1.8.8.T Aug 8th 2024    ||   1 此版本为测试版，2min开热水 2min关热水

*** V1.8.9 Aug 9th 2024      ||   1 补充了部分注释
							 ||   2 此版本为全功能的稳定版
							 
*** V1.9.0 Aug 13th 2024     ||   1 修复了烧录代码后默认为高原模式的问题,现在烧录完程序默认普通模式

*** V1.9.1 Aug 14th 2024     ||   1 增加了每24小时自动复位一次的功能

*** V1.9.2 Aug 16th 2024     ||   1 修复了流量计误触发的问题 
							 ||   2 童锁按键和高原模式切换按键改为长按五秒
							 
~~~ V1.9.3 Aug 17th 2024     ||   1 修改了高原模式与普通模式切换的方式,从长按5s切换更改为上电一分钟之内长按5s切换模式  
							 ||   2 修改了缺水保护的代码
//------------------------------------------------------------
